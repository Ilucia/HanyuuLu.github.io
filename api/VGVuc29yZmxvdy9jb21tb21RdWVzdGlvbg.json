{"title":"炼丹路上那些踩过的坑","date":"2019-02-10T00:00:00.000Z","link":"Tensorflow/commomQuestion","tags":["OpenCV, vsCode, tensorflow, confilct"],"updated":"2022-04-27T15:24:01.715Z","content":"<h2 id=\"font-colorred使用vscode运行opencv劝退事宜font\"><a class=\"markdownIt-Anchor\" href=\"Tensorflow/commomQuestion#font-colorred使用vscode运行opencv劝退事宜font\"></a> <font color=\"red\"><strong>使用VSCode运行openCV劝退事宜</strong></font><a href=\"Tensorflow/commomQuestion#font-colorred使用vscode运行opencv劝退事宜font\"></a></h2>\n<p>您若使用VSCode尝试Debug openCV-Python，<font color=\"red\">我们<strong>强烈</strong>建议您立刻放弃这样的尝试</font>。因为目前VSCode插件pylint无法正常解析openCV-python.<a href=\"https://github.com/Microsoft/vscode/issues/46798\" target=\"_blank\" rel=\"noopener\">详情请见VSCode团队官方issue</a><br>\n推荐使用<a href=\"https://www.jetbrains.com/pycharm/\" target=\"_blank\" rel=\"noopener\">PyCharm</a>或者<a href=\"https://www.vim.org/\" target=\"_blank\" rel=\"noopener\">Vim(高级玩家限定)</a></p>\n<h2 id=\"why-i-have-an-errorcv2waitkey0-0xff\"><a class=\"markdownIt-Anchor\" href=\"Tensorflow/commomQuestion#why-i-have-an-errorcv2waitkey0-0xff\"></a> Why I have an error:<code>cv2.waitkey(0) &amp; 0xff</code><a href=\"Tensorflow/commomQuestion#why-i-have-an-errorcv2waitkey0-0xff\"></a></h2>\n<ul>\n<li>高位的2个字节由Shift, Control, Num lock等状态表示，为了消除他们的影响统一用&amp; 0xff清除这些信息。</li>\n<li><a href=\"https://stackoverflow.com/questions/35372700/whats-0xff-for-in-cv2-waitkey1\" target=\"_blank\" rel=\"noopener\">原文摘录，戳我跳转</a>:<br>\nThe answers which have already been posted suggest that some of the unusual values obtained by waitKey are due to platform differences. Below, I propose that (at least on some platforms) the apparently odd behaviour of waitKey is due to keyboard modifiers. This post looks similar to Tomasz’s answer because I initially wrote this as an edit, which was rejected.<br>\nThe keycodes returned by waitKey change depending on which modifiers are enabled. NumLock, CapsLock, and the Shift, Ctrl, and Alt keys all modify the keycode returned by waitKey by enabling certain bits above the two Least Significant Bytes. The smallest of these flags is Shift at 0x10000.<br>\nA modified version of the script Tomasz posted is given below:</li>\n</ul>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\">cv2.imshow(sys.argv[<span class=\"number\">1</span>], cv2.imread(sys.argv[<span class=\"number\">1</span>]))</span><br><span class=\"line\">res = cv2.waitKey(<span class=\"number\">0</span>)</span><br><span class=\"line\">print(<span class=\"string\">'You pressed %d (0x%x), 2LSB: %d (%s)'</span> % (res, res, res % <span class=\"number\">2</span>**<span class=\"number\">16</span>,repr(chr(res%<span class=\"number\">256</span>)) <span class=\"keyword\">if</span> res%<span class=\"number\">256</span> &lt; <span class=\"number\">128</span> <span class=\"keyword\">else</span> <span class=\"string\">'?'</span>))</span><br><span class=\"line\">    <span class=\"comment\"># Which give the following results:</span></span><br><span class=\"line\">    <span class=\"comment\"># q letter with NumLock:</span></span><br><span class=\"line\">    <span class=\"comment\"># You pressed 1048689 (0x100071), 2LSB: 113 ('q')</span></span><br><span class=\"line\">    <span class=\"comment\"># Escape key with CapsLock but not NumLock:</span></span><br><span class=\"line\">    <span class=\"comment\"># You pressed 131099 (0x2001b), 2LSB: 27 ('\\x1b')</span></span><br><span class=\"line\">    <span class=\"comment\"># Space with Shift and NumLock:</span></span><br><span class=\"line\">    <span class=\"comment\"># You pressed 1114144 (0x110020), 2LSB: 32 (' ')</span></span><br><span class=\"line\">    <span class=\"comment\"># Right Arrow Key with Control, NumLock off:</span></span><br><span class=\"line\">    <span class=\"comment\"># You pressed 327507 (0x4ff53), 2LSB: 65363 ('S')</span></span><br></pre></td></tr></table></div></figure>\n<p>I hope that helps to explain the unusual behaviour of waitKey and how to get the actual key pressed regardless of the state of NumLock and CapLock. From here it’s relatively simple to do something like:</p>\n <figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ctrlPressed = 0 != res &amp; (1 &lt;&lt; 18)</span><br></pre></td></tr></table></div></figure>\n<p>…as the “control key” flag is bit 19. Shift is at bit 17, the state of CapsLock at bit 18, Alt is at bit 20, and NumLock is at bit 21.</p>\n<h2 id=\"cudnn-初始化失败\"><a class=\"markdownIt-Anchor\" href=\"Tensorflow/commomQuestion#cudnn-初始化失败\"></a> cuDNN 初始化失败<a href=\"Tensorflow/commomQuestion#cudnn-初始化失败\"></a></h2>\n<blockquote>\n<p>Error : Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.</p>\n</blockquote>\n<p>如果您使用的Tensorflow版本是1.12.0…… <br>\n这可能是个tensorflow的bug、建议回退版本观望， <br>\n<a href=\"https://github.com/tensorflow/tensorflow/issues/24828\" target=\"_blank\" rel=\"noopener\">issue on github</a></p>\n<h2 id=\"matplotlib-inline-报错-font-colorredinvalid-syntaxfont\"><a class=\"markdownIt-Anchor\" href=\"Tensorflow/commomQuestion#matplotlib-inline-报错-font-colorredinvalid-syntaxfont\"></a> %matplotlib inline 报错 <font color=\"red\">invalid syntax</font><a href=\"Tensorflow/commomQuestion#matplotlib-inline-报错-font-colorredinvalid-syntaxfont\"></a></h2>\n<p>%matplotlib inline 是jupyter notebook/console的语法，当你调用<code>matplotlib.pyplot</code>绘图函数<code>plot()</code>或生成figure时，在python console里面生成图像。<br>\n如果在其他地方运行，可直接注释。</p>\n","prev":{"title":"Python 依赖冲突","link":"Tensorflow/packageConflicts"},"next":{"title":"Medical image Data Processing","link":"deeplearning/MedicalimageDataProcessing"},"plink":"ilucia.github.io/Tensorflow/commomQuestion/","toc":[{"title":"<a class=\"markdownIt-Anchor\"><strong>使用VSCode运行openCV劝退事宜</strong></font>","id":"font-colorred使用vscode运行opencv劝退事宜font","index":"1"},{"title":"<a class=\"markdownIt-Anchor\"></a> Why I have an error:<code>cv2.waitkey(0) &amp; 0xff</code>","id":"why-i-have-an-errorcv2waitkey0-0xff","index":"2"},{"title":"<a class=\"markdownIt-Anchor\"></a> cuDNN 初始化失败","id":"cudnn-初始化失败","index":"3"},{"title":"<a class=\"markdownIt-Anchor\">invalid syntax</font>","id":"matplotlib-inline-报错-font-colorredinvalid-syntaxfont","index":"4"}],"copyright":{"author":"Ilucia Niu","license":"<a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\">知识共享署名 4.0 国际许可协议</a>","published":"2019年2月10日","updated":"2022年4月27日"}}