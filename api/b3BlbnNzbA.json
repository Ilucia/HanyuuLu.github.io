{"title":"使用OpenSSL生成SSL数字认证以用于Nginx的HTTPS通信","date":"2020-03-22T00:00:00.000Z","link":"openssl","tags":["HTTPS","Nginx","SSL"],"updated":"2022-04-27T15:24:01.727Z","content":"<ul>\n<li>\n<p>生成私钥</p>\n<p><code>openssl genrsa -out private.pem 2048</code></p>\n</li>\n<li>\n<p>利用生成的私钥生成公钥</p>\n<p><code>openssl req -x500 -key private.pem -out cert.pem -days 3650</code></p>\n</li>\n<li>\n<p>修改配置文件</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">\tlisten 443;    </span><br><span class=\"line\">\tssl on;    </span><br><span class=\"line\">\tssl_certificate /etc/ssl/cacert.pem;        </span><br><span class=\"line\">\t# path to your cacert.pem    </span><br><span class=\"line\">\tssl_certificate_key /etc/ssl/privkey.pem;    </span><br><span class=\"line\">  # path to your privkey.pem    </span><br><span class=\"line\">  server_name seafile.example.com;    </span><br><span class=\"line\">  server_tokens off;    </span><br><span class=\"line\">  # ......    </span><br><span class=\"line\">  proxy_pass http://127.0.0.1:8000;    </span><br><span class=\"line\">  proxy_set_header   Host $host;    </span><br><span class=\"line\">  proxy_set_header   X-Real-IP $remote_addr;    </span><br><span class=\"line\">  proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;    </span><br><span class=\"line\">  proxy_set_header   X-Forwarded-Host $server_name;    </span><br><span class=\"line\">  proxy_set_header   X-Forwarded-Proto https;</span><br><span class=\"line\">  proxy_read_timeout  1200s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li>\n<p>强制将http请求转为https请求</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen  80;</span><br><span class=\"line\">        listen  [::]:80;</span><br><span class=\"line\">        rewrite ^ https://$http_host$request_uri? permanent;</span><br><span class=\"line\">        server_tokens off;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n</ul>\n","prev":{"title":"Java GC 机制备忘","link":"java_gc"},"next":{"title":"数据库实践复习提纲","link":"Review/database"},"plink":"ilucia.github.io/openssl/","copyright":{"author":"Ilucia Niu","license":"<a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\">知识共享署名 4.0 国际许可协议</a>","published":"2020年3月22日","updated":"2022年4月27日"}}