{"title":"spring&mybatis/Mybatis - MybatisPlus","date":"2022-04-27T15:24:01.747Z","link":"spring&mybatis/Mybatis - MybatisPlus","updated":"2022-04-27T15:24:01.747Z","content":"<h2 id=\"mybatis\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#mybatis\"></a> Mybatis<a href=\"spring&mybatis/Mybatis - MybatisPlus#mybatis\"></a></h2>\n<h3 id=\"步骤\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#步骤\"></a> 步骤<a href=\"spring&mybatis/Mybatis - MybatisPlus#步骤\"></a></h3>\n<h5 id=\"创建表\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#创建表\"></a> 创建表<a href=\"spring&mybatis/Mybatis - MybatisPlus#创建表\"></a></h5>\n<h5 id=\"创建实体\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#创建实体\"></a> 创建实体<a href=\"spring&mybatis/Mybatis - MybatisPlus#创建实体\"></a></h5>\n<h5 id=\"创建配置文件\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#创建配置文件\"></a> 创建配置文件<a href=\"spring&mybatis/Mybatis - MybatisPlus#创建配置文件\"></a></h5>\n<ul>\n<li><strong>创建mybatis的配置⽂件，配置数据库的信息</strong></li>\n<li><strong>数据库我们可以配置多个，但是默认的只能⽤⼀个</strong></li>\n</ul>\n<h5 id=\"创建映射文件\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#创建映射文件\"></a> 创建映射文件<a href=\"spring&mybatis/Mybatis - MybatisPlus#创建映射文件\"></a></h5>\n<ul>\n<li>SQL语句在映射文件中</li>\n</ul>\n<h5 id=\"crud\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#crud\"></a> CRUD<a href=\"spring&mybatis/Mybatis - MybatisPlus#crud\"></a></h5>\n<ul>\n<li>\n<p>create read update delete</p>\n</li>\n<li>\n<p>insert/update/delete标签只是⼀个模板，在做操作时，其实是以SQL语句为核⼼的</p>\n<ul>\n<li>即在做增删改时，insert/update/delete标签可通⽤，</li>\n</ul>\n</li>\n<li>\n<p>但做查询时只能⽤select标签</p>\n</li>\n<li>\n<p>我们提倡什么操作就⽤什么标签</p>\n</li>\n</ul>\n<h4 id=\"创建工具类测试\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#创建工具类测试\"></a> 创建工具类测试<a href=\"spring&mybatis/Mybatis - MybatisPlus#创建工具类测试\"></a></h4>\n<ul>\n<li>Mybatis中的事务是默认开启的，因此我们在完成操作以后，需要我们⼿动去提交事务</li>\n</ul>\n<h3 id=\"扩展功能\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#扩展功能\"></a> 扩展功能<a href=\"spring&mybatis/Mybatis - MybatisPlus#扩展功能\"></a></h3>\n<h4 id=\"创建dao\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#创建dao\"></a> 创建DAO<a href=\"spring&mybatis/Mybatis - MybatisPlus#创建dao\"></a></h4>\n<h4 id=\"分页\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#分页\"></a> 分页<a href=\"spring&mybatis/Mybatis - MybatisPlus#分页\"></a></h4>\n<h4 id=\"动态sql\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#动态sql\"></a> 动态SQL<a href=\"spring&mybatis/Mybatis - MybatisPlus#动态sql\"></a></h4>\n<h5 id=\"动态查询\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#动态查询\"></a> 动态查询<a href=\"spring&mybatis/Mybatis - MybatisPlus#动态查询\"></a></h5>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--多条件查询【动态SQL】--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--会⾃动组合成⼀个正常的WHERE字句--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--name值会从map中寻找--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"findByCondition\"</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">\"studentMap\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"map\"</span>&gt;</span></span><br><span class=\"line\">  select * from users</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"uname!=null\"</span>&gt;</span></span><br><span class=\"line\">    \tand uname=#&#123;uname&#125;</span><br><span class=\"line\">  \t<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">  \t<span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"uage!=null\"</span>&gt;</span></span><br><span class=\"line\">  \t\tand uage <span class=\"tag\">&lt; #&#123;<span class=\"attr\">uage</span>&#125;</span></span><br><span class=\"line\">  \t&lt;/if&gt;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">where</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<ul>\n<li>查询名字为name，年龄小于age的人\n<ul>\n<li>为null则代表该字段无条件</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> List&lt;User&gt; <span class=\"title\">findByCondition</span><span class=\"params\">(String name,Integer age)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//得到连接对象</span></span><br><span class=\"line\">    SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//映射⽂件的命名空间.SQL⽚段的ID，就可以调⽤对应的映射⽂件中的SQL</span></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 由于我们的参数超过了两个，⽽⽅法中只有⼀个Object参数收集</span></span><br><span class=\"line\"><span class=\"comment\">         * 因此我们可以使⽤Map集合来装载我们的参数</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> HashMap();</span><br><span class=\"line\">        map.put(<span class=\"string\">\"uname\"</span>, name);</span><br><span class=\"line\">        map.put(<span class=\"string\">\"uage\"</span>, age);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sqlSession.selectList(<span class=\"string\">\"findByCondition\"</span>, map);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">        sqlSession.rollback();</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> e;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">        MybatisUtil.closeSqlSession();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"choose-when-otherwise\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#choose-when-otherwise\"></a> choose, when, otherwise<a href=\"spring&mybatis/Mybatis - MybatisPlus#choose-when-otherwise\"></a></h2>\n<p>有些时候，我们不想用到所有的条件语句，而只想从中择其一二。针对这种情况，MyBatis 提供了 choose 元素，它有点像 Java 中的 switch 语句。</p>\n<p>还是上面的例子，但是这次变为提供了&quot;title&quot;就按&quot;title&quot;查找，提供了&quot;author&quot;就按&quot;author&quot;查找，若两者都没有提供，就返回所有符合条件的BLOG（实际情况可能是由管理员按一定策略选出BLOG列表，而不是返回大量无意义的随机结果）。</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"findActiveBlogLike\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">resultType</span>=<span class=\"string\">\"Blog\"</span>&gt;</span></span><br><span class=\"line\">  SELECT * FROM BLOG WHERE state = ‘ACTIVE’</span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">\"title != null\"</span>&gt;</span></span><br><span class=\"line\">      AND title like #&#123;title&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">test</span>=<span class=\"string\">\"author != null and author.name != null\"</span>&gt;</span></span><br><span class=\"line\">      AND author_name like #&#123;author.name&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">when</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">      AND featured = 1</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">otherwise</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">choose</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<h2 id=\"trim-where-set\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#trim-where-set\"></a> trim, where, set<a href=\"spring&mybatis/Mybatis - MybatisPlus#trim-where-set\"></a></h2>\n<p>前面几个例子已经合宜地解决了一个臭名昭著的动态 SQL 问题。现在考虑回到&quot;if&quot;示例，这次我们将&quot;ACTIVE = 1&quot;也设置成动态的条件，看看会发生什么。</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"findActiveBlogLike\"</span></span></span><br><span class=\"line\"><span class=\"tag\">     <span class=\"attr\">resultType</span>=<span class=\"string\">\"Blog\"</span>&gt;</span></span><br><span class=\"line\">  SELECT * FROM BLOG </span><br><span class=\"line\">  WHERE </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"state != null\"</span>&gt;</span></span><br><span class=\"line\">    state = #&#123;state&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"title != null\"</span>&gt;</span></span><br><span class=\"line\">    AND title like #&#123;title&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"author != null and author.name != null\"</span>&gt;</span></span><br><span class=\"line\">    AND author_name like #&#123;author.name&#125;</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>如果这些条件没有一个能匹配上将会怎样？最终这条 SQL 会变成这样：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> BLOG</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br></pre></td></tr></table></div></figure>\n<p>这会导致查询失败。如果仅仅第二个条件匹配又会怎样？这条 SQL 最终会是这样:</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> BLOG</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\"><span class=\"keyword\">AND</span> title <span class=\"keyword\">like</span> <span class=\"string\">'someTitle'</span></span><br></pre></td></tr></table></div></figure>\n<p>这个查询也会失败。这个问题不能简单的用条件句式来解决，如果你也曾经被迫这样写过，那么你很可能从此以后都不想再这样去写了。</p>\n<p>MyBatis 有一个简单的处理，这在90%的情况下都会有用。而在不能使用的地方，你可以自定义处理方式来令其正常工作。一处简单的修改就能得到想要的效果：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;select id=&quot;findActiveBlogLike&quot;</span><br><span class=\"line\">     resultType=&quot;Blog&quot;&gt;</span><br><span class=\"line\">  SELECT * FROM BLOG </span><br><span class=\"line\">  &lt;where&gt; </span><br><span class=\"line\">    &lt;if test=&quot;state != null&quot;&gt;</span><br><span class=\"line\">         state = #&#123;state&#125;</span><br><span class=\"line\">    &lt;/if&gt; </span><br><span class=\"line\">    &lt;if test=&quot;title != null&quot;&gt;</span><br><span class=\"line\">        AND title like #&#123;title&#125;</span><br><span class=\"line\">    &lt;/if&gt;</span><br><span class=\"line\">    &lt;if test=&quot;author != null and author.name != null&quot;&gt;</span><br><span class=\"line\">        AND author_name like #&#123;author.name&#125;</span><br><span class=\"line\">    &lt;/if&gt;</span><br><span class=\"line\">  &lt;/where&gt;</span><br><span class=\"line\">&lt;/select&gt;</span><br></pre></td></tr></table></div></figure>\n<p>where 元素知道只有在一个以上的if条件有值的情况下才去插入&quot;WHERE&quot;子句。而且，若最后的内容是&quot;AND&quot;或&quot;OR&quot;开头的，where 元素也知道如何将他们去除。</p>\n<p>如果 where 元素没有按正常套路出牌，我们还是可以通过自定义 trim 元素来定制我们想要的功能。比如，和 where 元素等价的自定义 trim 元素为：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;trim prefix=&quot;WHERE&quot; prefixOverrides=&quot;AND |OR &quot;&gt;</span><br><span class=\"line\">  ... </span><br><span class=\"line\">&lt;/trim&gt;</span><br></pre></td></tr></table></div></figure>\n<p>prefixOverrides 属性会忽略通过管道分隔的文本序列（注意此例中的空格也是必要的）。它带来的结果就是所有在 prefixOverrides 属性中指定的内容将被移除，并且插入 prefix 属性中指定的内容。</p>\n<p>类似的用于动态更新语句的解决方案叫做 set。set 元素可以被用于动态包含需要更新的列，而舍去其他的。比如：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">update</span> <span class=\"attr\">id</span>=<span class=\"string\">\"updateAuthorIfNecessary\"</span>&gt;</span></span><br><span class=\"line\">  update Author</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"username != null\"</span>&gt;</span>username=#&#123;username&#125;,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"password != null\"</span>&gt;</span>password=#&#123;password&#125;,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"email != null\"</span>&gt;</span>email=#&#123;email&#125;,<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"bio != null\"</span>&gt;</span>bio=#&#123;bio&#125;<span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">  where id=#&#123;id&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">update</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>这里，set 元素会动态前置 SET 关键字，同时也会消除无关的逗号，因为用了条件语句之后很可能就会在生成的赋值语句的后面留下这些逗号。</p>\n<p>若你对等价的自定义 trim 元素的样子感兴趣，那这就应该是它的真面目：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;trim prefix=&quot;SET&quot; suffixOverrides=&quot;,&quot;&gt;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&lt;/trim&gt;</span><br></pre></td></tr></table></div></figure>\n<p>注意这里我们忽略的是后缀中的值，而又一次附加了前缀中的值。</p>\n<h2 id=\"foreach\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#foreach\"></a> foreach<a href=\"spring&mybatis/Mybatis - MybatisPlus#foreach\"></a></h2>\n<p>动态 SQL 的另外一个常用的必要操作是需要对一个集合进行遍历，通常是在构建 IN 条件语句的时候。比如：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;select id=&quot;selectPostIn&quot; resultType=&quot;domain.blog.Post&quot;&gt;</span><br><span class=\"line\">  SELECT *</span><br><span class=\"line\">  FROM POST P</span><br><span class=\"line\">  WHERE ID in</span><br><span class=\"line\">  &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot;</span><br><span class=\"line\">      open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class=\"line\">        #&#123;item&#125;</span><br><span class=\"line\">  &lt;/foreach&gt;</span><br><span class=\"line\">&lt;/select&gt;</span><br></pre></td></tr></table></div></figure>\n<p>foreach 元素的功能是非常强大的，它允许你指定一个集合，声明可以用在元素体内的集合项和索引变量。它也允许你指定开闭匹配的字符串以及在迭代中间放置分隔符。这个元素是很智能的，因此它不会偶然地附加多余的分隔符。</p>\n<p>注意 你可以将一个 List 实例或者数组作为参数对象传给 MyBatis，当你这么做的时候，MyBatis 会自动将它包装在一个 Map 中并以名称为键。List 实例将会以&quot;list&quot;作为键，而数组实例的键将是&quot;array&quot;。</p>\n<p>到此我们已经完成了涉及 XML 配置文件和 XML 映射文件的讨论。下一部分将详细探讨 Java API，这样才能从已创建的映射中获取最大利益。</p>\n<h2 id=\"bind\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#bind\"></a> bind<a href=\"spring&mybatis/Mybatis - MybatisPlus#bind\"></a></h2>\n<p><code>bind</code> 元素可以从 OGNL 表达式中创建一个变量并将其绑定到上下文。比如：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;select id=&quot;selectBlogsLike&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class=\"line\">  &lt;bind name=&quot;pattern&quot; value=&quot;&apos;%&apos; + _parameter.getTitle() + &apos;%&apos;&quot; /&gt;</span><br><span class=\"line\">  SELECT * FROM BLOG</span><br><span class=\"line\">  WHERE title LIKE #&#123;pattern&#125;</span><br><span class=\"line\">&lt;/select&gt;</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"multi-db-vendor-support\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#multi-db-vendor-support\"></a> Multi-db vendor support<a href=\"spring&mybatis/Mybatis - MybatisPlus#multi-db-vendor-support\"></a></h2>\n<p>一个配置了&quot;_databaseId&quot;变量的 databaseIdProvider 对于动态代码来说是可用的，这样就可以根据不同的数据库厂商构建特定的语句。比如下面的例子：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">\"insert\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"int\"</span> <span class=\"attr\">order</span>=<span class=\"string\">\"BEFORE\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"_databaseId == 'oracle'\"</span>&gt;</span></span><br><span class=\"line\">      select seq_users.nextval from dual</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">if</span> <span class=\"attr\">test</span>=<span class=\"string\">\"_databaseId == 'db2'\"</span>&gt;</span></span><br><span class=\"line\">      select nextval for seq_users from sysibm.sysdummy1\"</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">if</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></span><br><span class=\"line\">  insert into users values (#&#123;id&#125;, #&#123;name&#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<h2 id=\"动态-sql-中可插拔的脚本语言\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#动态-sql-中可插拔的脚本语言\"></a> 动态 SQL 中可插拔的脚本语言<a href=\"spring&mybatis/Mybatis - MybatisPlus#动态-sql-中可插拔的脚本语言\"></a></h2>\n<p>MyBatis 从 3.2 开始支持可插拔的脚本语言，因此你可以在插入一种语言的驱动（language driver）之后来写基于这种语言的动态 SQL 查询。</p>\n<p>可以通过实现下面接口的方式来插入一种语言：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">LanguageDriver</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\">ParameterHandler <span class=\"title\">createParameterHandler</span><span class=\"params\">(MappedStatement mappedStatement, Object parameterObject, BoundSql boundSql)</span></span>;</span><br><span class=\"line\">  <span class=\"function\">SqlSource <span class=\"title\">createSqlSource</span><span class=\"params\">(Configuration configuration, XNode script, Class parameterType)</span></span>;</span><br><span class=\"line\">  <span class=\"function\">SqlSource <span class=\"title\">createSqlSource</span><span class=\"params\">(Configuration configuration, String script, Class parameterType)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>一旦有了自定义的语言驱动，你就可以在 mybatis-config.xml 文件中将它设置为默认语言：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">typeAliases</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">typeAlias</span> <span class=\"attr\">type</span>=<span class=\"string\">\"org.sample.MyLanguageDriver\"</span> <span class=\"attr\">alias</span>=<span class=\"string\">\"myLanguage\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">typeAliases</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"defaultScriptingLanguage\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"myLanguage\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>除了设置默认语言，你也可以针对特殊的语句指定特定语言，这可以通过如下的 <code>lang</code> 属性来完成：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"selectBlog\"</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"myLanguage\"</span>&gt;</span></span><br><span class=\"line\">  SELECT * FROM BLOG</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>或者在你正在使用的映射中加上注解 <code>@Lang</code> 来完成：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Mapper</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"meta\">@Lang</span>(MyLanguageDriver.class)</span><br><span class=\"line\">  <span class=\"meta\">@Select</span>(<span class=\"string\">\"SELECT * FROM BLOG\"</span>)</span><br><span class=\"line\">  <span class=\"function\">List <span class=\"title\">selectBlog</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>注意 可以将 Apache Velocity 作为动态语言来使用，更多细节请参考 MyBatis-Velocity 项目。</p>\n<p>你前面看到的所有 xml 标签都是默认 MyBatis 语言提供的，它是由别名为 <code>xml</code> 语言驱动器 <code>org.apache.ibatis.scripting.xmltags.XmlLanguageDriver</code> 驱动的。</p>\n<h3 id=\"注解\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#注解\"></a> 注解<a href=\"spring&mybatis/Mybatis - MybatisPlus#注解\"></a></h3>\n<div class=\"article-bounded\"><div class=\"article-table\"><table>\n<thead>\n<tr>\n<th>注解</th>\n<th style=\"text-align:center\">目标</th>\n<th>相对应的 XML</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>@CacheNamespace</code></td>\n<td style=\"text-align:center\"><code>类</code></td>\n<td>``</td>\n<td>为给定的命名空间 (比如类) 配置缓存。 属性:implemetation,eviction, flushInterval,size 和 readWrite。</td>\n</tr>\n<tr>\n<td><code>@CacheNamespaceRef</code></td>\n<td style=\"text-align:center\"><code>类</code></td>\n<td>``</td>\n<td>参照另外一个命名空间的缓存来使用。 属性:value,应该是一个名空间的字 符串值(也就是类的完全限定名) 。</td>\n</tr>\n<tr>\n<td><code>@ConstructorArgs</code></td>\n<td style=\"text-align:center\"><code>Method</code></td>\n<td>``</td>\n<td>收集一组结果传递给一个劫夺对象的 构造方法。属性:value,是形式参数 的数组。</td>\n</tr>\n<tr>\n<td><code>@Arg</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td></td>\n<td>单 独 的 构 造 方 法 参 数 , 是 ConstructorArgs 集合的一部分。属性: id,column,javaType,typeHandler。 id 属性是布尔值, 来标识用于比较的属 性,和XML 元素相似。</td>\n</tr>\n<tr>\n<td><code>@TypeDiscriminator</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td>``</td>\n<td>一组实例值被用来决定结果映射的表 现。 属性: column, javaType, jdbcType, typeHandler,cases。cases 属性就是实 例的数组。</td>\n</tr>\n<tr>\n<td><code>@Case</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td>``</td>\n<td>单独实例的值和它对应的映射。属性: value,type,results。Results 属性是结 果数组,因此这个注解和实际的 ResultMap 很相似,由下面的 Results 注解指定。</td>\n</tr>\n<tr>\n<td><code>@Results</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td>``</td>\n<td>结果映射的列表, 包含了一个特别结果 列如何被映射到属性或字段的详情。 属 性:value,是 Result 注解的数组。</td>\n</tr>\n<tr>\n<td><code>@Result</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td></td>\n<td>在列和属性或字段之间的单独结果映 射。属 性:id,column, property, javaType ,jdbcType ,type Handler, one,many。id 属性是一个布尔值,表 示了应该被用于比较(和在 XML 映射 中的相似)的属性。one 属性是单 独 的 联 系, 和 相 似 , 而 many 属 性 是 对 集 合 而 言 的 , 和 相似。 它们这样命名是为了 避免名称冲突。</td>\n</tr>\n<tr>\n<td><code>@One</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td>``</td>\n<td>复杂类型的单独属性值映射。属性: select,已映射语句(也就是映射器方 法)的完全限定名,它可以加载合适类 型的实例。注意:联合映射在注解 API 中是不支持的。这是因为 Java 注解的 限制,不允许循环引用。<code>fetchType</code>, which supersedes the global configuration parameter<code>lazyLoadingEnabled</code> for this mapping.</td>\n</tr>\n<tr>\n<td><code>@Many</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td>``</td>\n<td>A mapping to a collection property of a complex type. Attributes:<code>select</code>, which is the fully qualified name of a mapped statement (i.e. mapper method) that can load a collection of instances of the appropriate types,<code>fetchType</code>, which supersedes the global configuration parameter<code>lazyLoadingEnabled</code> for this mapping. NOTE You will notice that join mapping is not supported via the Annotations API. This is due to the limitation in Java Annotations that does not allow for circular references.</td>\n</tr>\n<tr>\n<td><code>@MapKey</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td></td>\n<td>复 杂 类 型 的 集合 属 性 映射 。 属 性 : select,是映射语句(也就是映射器方 法)的完全限定名,它可以加载合适类 型的一组实例。注意:联合映射在 Java 注解中是不支持的。这是因为 Java 注 解的限制,不允许循环引用。</td>\n</tr>\n<tr>\n<td><code>@Options</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td>映射语句的属性</td>\n<td>这个注解提供访问交换和配置选项的 宽广范围, 它们通常在映射语句上作为 属性出现。 而不是将每条语句注解变复 杂,Options 注解提供连贯清晰的方式 来访问它们。属性:useCache=true , flushCache=false , resultSetType=FORWARD_ONLY , statementType=PREPARED , fetchSize=-1 , , timeout=-1 useGeneratedKeys=false , keyProperty=“id”。 理解 Java 注解是很 重要的,因为没有办法来指定&quot;null&quot; 作为值。因此,一旦你使用了 Options 注解,语句就受所有默认值的支配。要 注意什么样的默认值来避免不期望的 行为。</td>\n</tr>\n<tr>\n<td>* <code>@Insert</code>,<code>@Update</code>, <code>@Delete</code>, <code>@Select</code></td>\n<td style=\"text-align:center\"><code>方法</code></td>\n<td><code>&lt;insert&gt;</code>,<code>&lt;update&gt;</code>,<code>&lt;delete&gt;</code>,<code>&lt;select&gt;</code></td>\n<td>这些注解中的每一个代表了执行的真 实 SQL。 它们每一个都使用字符串数组 (或单独的字符串)。如果传递的是字 符串数组, 它们由每个分隔它们的单独 空间串联起来。这就当用 Java 代码构 建 SQL 时避免了“丢失空间”的问题。 然而,如果你喜欢,也欢迎你串联单独 的字符串。属性:value,这是字符串 数组用来组成单独的 SQL 语句。</td>\n</tr>\n<tr>\n<td>@InsertProvider,@UpdateProvider,@DeleteProvider,@SelectProvider</td>\n<td style=\"text-align:center\">方法</td>\n<td><code>&lt;insert&gt;</code>,<code>&lt;update&gt;</code>,<code>&lt;delete&gt;</code>,<code>&lt;select&gt;</code></td>\n<td>这些可选的 SQL 注解允许你指定一个 类名和一个方法在执行时来返回运行 允许创建动态 的 SQL。 基于执行的映射语句, MyBatis 会实例化这个类,然后执行由 provider 指定的方法. 这个方法可以选择性的接 受参数对象作为它的唯一参数, 但是必 须只指定该参数或者没有参数。属性: type,method。type 属性是类的完全限 定名。method 是该类中的那个方法名。 注意: 这节之后是对 SelectBuilder 类的 讨论,它可以帮助你以干净,容于阅读 的方式来构建动态 SQL。</td>\n</tr>\n<tr>\n<td><code>@Param</code></td>\n<td style=\"text-align:center\"><code>Parameter</code></td>\n<td>N/A</td>\n<td>如果你的映射器的方法需要多个参数, 这个注解可以被应用于映射器的方法 参数来给每个参数一个名字。否则,多 参数将会以它们的顺序位置来被命名 (不包括任何 RowBounds 参数) 比如。 #{param1} , #{param2} 等 , 这 是 默 认 的 。 使 用 @Param(“person”),参数应该被命名为 #{person}。</td>\n</tr>\n<tr>\n<td><code>@SelectKey</code></td>\n<td style=\"text-align:center\"><code>Method</code></td>\n<td><code>&lt;selectKey&gt;</code></td>\n<td>This annotation duplicates the `` functionality for methods annotated with<code>@Insert</code>,<code>@InsertProvider</code>,<code>@Update</code>or<code>@UpdateProvider</code>. It is ignored for other methods. If you specify a<code>@SelectKey</code>annotation, then MyBatis will ignore any generated key properties set via the<code>@Options</code>annotation, or configuration properties. Attributes: statement an array of strings which is the SQL statement to execute,<code>keyProperty</code>which is the property of the parameter object that will be updated with the new value, before which must be either<code>true</code>or<code>false</code>to denote if the SQL statement should be executed before or after the insert,<code>resultType</code>which is the Java type of the<code>keyProperty</code>, and<code>statementType=PREPARED</code>.</td>\n</tr>\n<tr>\n<td><code>@ResultMap</code></td>\n<td style=\"text-align:center\"><code>Method</code></td>\n<td>N/A</td>\n<td>This annotation is used to provide the id of a `` element in an XML mapper to a<code>@Select</code>or<code>@SelectProvider</code>annotation. This allows annotated selects to reuse resultmaps that are defined in XML. This annotation will override any<code>@Results</code>or<code>@ConstructorArgs</code> annotation if both are specified on an annotated select.</td>\n</tr>\n<tr>\n<td><code>@ResultType</code></td>\n<td style=\"text-align:center\"><code>Method</code></td>\n<td>N/A</td>\n<td>This annotation is used when using a result handler. In that case, the return type is void so MyBatis must have a way to determine the type of object to construct for each row. If there is an XML result map, use the @ResultMap annotation. If the result type is specified in XML on the ` Night Mode</td>\n</tr>\n</tbody>\n</table></div></div>\n<h4 id=\"映射申明样例\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#映射申明样例\"></a> 映射申明样例<a href=\"spring&mybatis/Mybatis - MybatisPlus#映射申明样例\"></a></h4>\n<p>这个例子展示了如何使用 @SelectKey 注解来在插入前读取数据库序列的值：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Insert(&quot;insert into table3 (id, name) values(#&#123;nameId&#125;, #&#123;name&#125;)&quot;)</span><br><span class=\"line\">@SelectKey(statement=&quot;call next value for TestSequence&quot;, keyProperty=&quot;nameId&quot;, before=true, resultType=int.class)</span><br><span class=\"line\">int insertTable3(Name name);</span><br></pre></td></tr></table></div></figure>\n<p>这个例子展示了如何使用 @SelectKey 注解来在插入后读取数据库识别列的值：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Insert(&quot;insert into table2 (name) values(#&#123;name&#125;)&quot;)</span><br><span class=\"line\">@SelectKey(statement=&quot;call identity()&quot;, keyProperty=&quot;nameId&quot;, before=false, resultType=int.class)</span><br><span class=\"line\">int insertTable2(Name name);</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"mybatis-plus\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#mybatis-plus\"></a> MyBatis Plus<a href=\"spring&mybatis/Mybatis - MybatisPlus#mybatis-plus\"></a></h2>\n<h3 id=\"一-mybatis-plus简介\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#一-mybatis-plus简介\"></a> 一、mybatis-plus简介：<a href=\"spring&mybatis/Mybatis - MybatisPlus#一-mybatis-plus简介\"></a></h3>\n<p>Mybatis-Plus（简称MP）是一个 Mybatis 的增强工具，在 Mybatis 的基础上只做增强不做改变，为简化开发、提高效率而生。这是官方给的定义，关于mybatis-plus的更多介绍及特性，可以参考<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2Fmp.baomidou.com%2F%23%2F\" target=\"_blank\" rel=\"noopener\">mybatis-plus官网</a>。那么它是怎么增强的呢？其实就是它已经封装好了一些crud方法，我们不需要再写xml了，直接调用这些方法就行，就类似于JPA。</p>\n<h3 id=\"二-spring整合mybatis-plus\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#二-spring整合mybatis-plus\"></a> 二、spring整合mybatis-plus:<a href=\"spring&mybatis/Mybatis - MybatisPlus#二-spring整合mybatis-plus\"></a></h3>\n<p>正如官方所说，mybatis-plus在mybatis的基础上只做增强不做改变，因此其与spring的整合亦非常简单。只需把mybatis的依赖换成mybatis-plus的依赖，再把sqlSessionFactory换成mybatis-plus的即可。接下来看具体操作：</p>\n<h4 id=\"1-pomxml\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#1-pomxml\"></a> <strong>1、pom.xml:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#1-pomxml\"></a></h4>\n<p>核心依赖如下：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- spring --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-context<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.3.14.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-orm<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.3.14.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.3.14.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- mp 依赖 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>**注意：**这些是核心依赖，本项目还用到了mysql驱动、c3p0、日志（slf4j-api，slf4j-log4j2）、lombok。集成mybatis-plus要把mybatis、mybatis-spring去掉，避免冲突；lombok是一个工具，添加了这个依赖，开发工具再安装Lombok插件，就可以使用它了，最常用的用法就是在实体类中使用它的@Data注解，这样实体类就不用写set、get、toString等方法了。关于Lombok的更多用法，请自行百度。</p>\n<h4 id=\"2-log4jxml\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#2-log4jxml\"></a> <strong>2、log4j.xml:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#2-log4jxml\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE log4j:configuration SYSTEM \"log4j.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">log4j:configuration</span> <span class=\"attr\">xmlns:log4j</span>=<span class=\"string\">\"http://jakarta.apache.org/log4j/\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"STDOUT\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.ConsoleAppender\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Encoding\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"UTF-8\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.PatternLayout\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"ConversionPattern\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%-5p %d&#123;MM-dd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">HH:mm:ss,SSS&#125; %m (%F:%L) \\n\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">logger</span> <span class=\"attr\">name</span>=<span class=\"string\">\"java.sql\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"debug\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">logger</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">logger</span> <span class=\"attr\">name</span>=<span class=\"string\">\"org.apache.ibatis\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"info\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">logger</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">root</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"debug\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"STDOUT\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">root</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">log4j:configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<h4 id=\"3-jdbcproperties\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#3-jdbcproperties\"></a> <strong>3、jdbc.properties:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#3-jdbcproperties\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class=\"line\">jdbc.url=<span class=\"symbol\">jdbc:</span><span class=\"symbol\">mysql:</span>/<span class=\"regexp\">//</span>数据库名?useUnicode=<span class=\"literal\">true</span>&amp;characterEncoding=utf8</span><br><span class=\"line\">jdbc.username=<span class=\"comment\">#</span></span><br><span class=\"line\">jdbc.password=<span class=\"comment\">#</span></span><br></pre></td></tr></table></div></figure>\n<h4 id=\"4-mybatis-configxml\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#4-mybatis-configxml\"></a> <strong>4、mybatis-config.xml:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#4-mybatis-configxml\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE configuration</span></span><br><span class=\"line\"><span class=\"meta\">PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">\"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>**注：**因为是与spring整合，所有mybatis-plus的大部分都写在spring的配置文件中，这里定义一个空的mybatis-config.xml即可。</p>\n<h4 id=\"5-spring-daoxml\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#5-spring-daoxml\"></a> <strong>5、spring-dao.xml:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#5-spring-daoxml\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span>    </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span>   </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:p</span>=<span class=\"string\">\"http://www.springframework.org/schema/p\"</span>  </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:aop</span>=<span class=\"string\">\"http://www.springframework.org/schema/aop\"</span>   </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:context</span>=<span class=\"string\">\"http://www.springframework.org/schema/context\"</span>  </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:jee</span>=<span class=\"string\">\"http://www.springframework.org/schema/jee\"</span>  </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:tx</span>=<span class=\"string\">\"http://www.springframework.org/schema/tx\"</span>  </span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"    </span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.0.xsd  </span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd  </span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd  </span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.0.xsd  </span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd\"</span>&gt;</span>    </span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 配置整合mybatis-plus过程 --&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 1、配置数据库相关参数properties的属性：$&#123;url&#125; --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:property-placeholder</span> <span class=\"attr\">location</span>=<span class=\"string\">\"classpath:jdbc.properties\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 2、配置数据库连接池 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.mchange.v2.c3p0.ComboPooledDataSource\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driverClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.driver&#125;\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"jdbcUrl\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.url&#125;\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.username&#125;\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.password&#125;\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- mybatis的sqlsessionFactorybean：org.mybatis.spring.SqlSessionFactoryBean--&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 3、配置mybatis-plus的sqlSessionFactory --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"sqlSessionFactory\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"dataSource\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"configLocation\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath:mybatis-config.xml\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"typeAliasesPackage\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.zhu.mybatisplus.entity\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 4、DAO接口所在包名，Spring会自动查找其下的类 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.mybatis.spring.mapper.MapperScannerConfigurer\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"basePackage\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.zhu.mybatisplus.dao\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"sqlSessionFactoryBeanName\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"sqlSessionFactory\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<h4 id=\"6-entity\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#6-entity\"></a> <strong>6、entity:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#6-entity\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(value = <span class=\"meta-string\">\"tb_employee\"</span>)</span><span class=\"comment\">//指定表名</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//value与数据库主键列名一致，若实体类属性名与表主键列名一致可省略value</span></span><br><span class=\"line\">    <span class=\"meta\">@TableId(value = <span class=\"meta-string\">\"id\"</span>,type = IdType.AUTO)</span><span class=\"comment\">//指定自增策略</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\">    <span class=\"comment\">//若没有开启驼峰命名，或者表中列名不符合驼峰规则，可通过该注解指定数据库表中的列名，exist标明数据表中有没有对应列</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = <span class=\"meta-string\">\"last_name\"</span>,exist = true)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String lastName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String email;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer gender;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer age;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<h4 id=\"7-mapper\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#7-mapper\"></a> <strong>7、mapper:</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#7-mapper\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">EmplopyeeDao</span> <span class=\"keyword\">extends</span> <span class=\"title\">BaseMapper</span>&lt;<span class=\"title\">Employee</span>&gt; </span>&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>这样就完成了mybatis-plus与spring的整合。首先是把mybatis和mybatis-spring依赖换成mybatis-plus的依赖，然后把sqlsessionfactory换成mybatis-plus的，然后实体类中添加<code>@TableName</code>、<code>@TableId</code>等注解，最后mapper继承<code>BaseMapper</code>即可。</p>\n<h4 id=\"8-测试\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#8-测试\"></a> <strong>8、测试：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#8-测试\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class=\"line\"><span class=\"meta\">@ContextConfiguration</span>(&#123;<span class=\"string\">\"classpath:spring/spring-dao.xml\"</span>&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DataSource dataSource;</span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testDataSource</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">        System.out.println(dataSource.getConnection());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>运行该junit，可输出获取到的连接，说明整合没问题：</p>\n<h3 id=\"三-mp的通用crud\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#三-mp的通用crud\"></a> 三、mp的通用crud<a href=\"spring&mybatis/Mybatis - MybatisPlus#三-mp的通用crud\"></a></h3>\n<ul>\n<li><strong>需求：</strong>\n<ul>\n<li>存在一张 tb_employee 表，且已有对应的实体类 Employee，实现tb_employee 表的 CRUD 操作我们需要做什么呢？</li>\n</ul>\n</li>\n<li><strong>基于 Mybatis：</strong>\n<ul>\n<li>需要编写 EmployeeMapper 接口，并在 EmployeeMapper.xml 映射文件中手动编写 CRUD 方法对应的sql语句。</li>\n</ul>\n</li>\n<li><strong>基于 MP：</strong>\n<ul>\n<li>只需要创建 EmployeeMapper 接口, 并继承 BaseMapper 接口</li>\n<li>我们已经有了Employee、tb_employee了，并且EmployeeDao也继承了BaseMapper了，接下来就使用crud方法</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"1-insert操作\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#1-insert操作\"></a> <strong>1、insert操作：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#1-insert操作\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class=\"line\"><span class=\"meta\">@ContextConfiguration</span>(&#123;<span class=\"string\">\"classpath:spring/spring-dao.xml\"</span>&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> EmplopyeeDao emplopyeeDao;</span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testInsert</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Employee employee = <span class=\"keyword\">new</span> Employee();</span><br><span class=\"line\">        employee.setLastName(<span class=\"string\">\"东方不败\"</span>);</span><br><span class=\"line\">        employee.setEmail(<span class=\"string\">\"dfbb@163.com\"</span>);</span><br><span class=\"line\">        employee.setGender(<span class=\"number\">1</span>);</span><br><span class=\"line\">        employee.setAge(<span class=\"number\">20</span>);</span><br><span class=\"line\">        emplopyeeDao.insert(employee);</span><br><span class=\"line\">        <span class=\"comment\">//mybatisplus会自动把当前插入对象在数据库中的id写回到该实体中</span></span><br><span class=\"line\">        System.out.println(employee.getId());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>执行添加操作，直接调用insert方法传入实体即可。</p>\n<h4 id=\"2-update操作\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#2-update操作\"></a> <strong>2、update操作：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#2-update操作\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testUpdate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Employee employee = <span class=\"keyword\">new</span> Employee();</span><br><span class=\"line\">        employee.setId(<span class=\"number\">1</span>);</span><br><span class=\"line\">        employee.setLastName(<span class=\"string\">\"更新测试\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//emplopyeeDao.updateById(employee);//根据id进行更新，没有传值的属性就不会更新</span></span><br><span class=\"line\">        emplopyeeDao.updateAllColumnById(employee);<span class=\"comment\">//根据id进行更新，没传值的属性就更新为null</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>**注：**注意这两个update操作的区别，<code>updateById</code>方法，没有传值的字段不会进行更新，比如只传入了lastName，那么age、gender等属性就会保留原来的值；<code>updateAllColumnById</code>方法，顾名思义，会更新所有的列，没有传值的列会更新为null。</p>\n<h4 id=\"3-select操作\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#3-select操作\"></a> <strong>3、select操作：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#3-select操作\"></a></h4>\n<p>**(1)、**根据id查询：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Employee employee = emplopyeeDao.selectById(1);</span><br></pre></td></tr></table></div></figure>\n<p>**(2)、**根据条件查询一条数据：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Employee employeeCondition = <span class=\"keyword\">new</span> Employee();</span><br><span class=\"line\">employeeCondition.setId(<span class=\"number\">1</span>);</span><br><span class=\"line\">employeeCondition.setLastName(<span class=\"string\">\"更新测试\"</span>);</span><br><span class=\"line\"><span class=\"comment\">//若是数据库中符合传入的条件的记录有多条，那就不能用这个方法，会报错</span></span><br><span class=\"line\">Employee employee = emplopyeeDao.selectOne(employeeCondition);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**这个方法的sql语句就是<code>where id = 1 and last_name = 更新测试</code>，若是符合这个条件的记录不止一条，那么就会报错。</p>\n<p>**(3)、**根据查询条件返回多条数据：<br>\n当符合指定条件的记录数有多条时，上面那个方法就会报错，就应该用这个方法。</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Map</span>&lt;<span class=\"built_in\">String</span>,<span class=\"built_in\">Object</span>&gt; columnMap = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">columnMap.put(<span class=\"string\">\"last_name\"</span>,<span class=\"string\">\"东方不败\"</span>);<span class=\"comment\">//写表中的列名</span></span><br><span class=\"line\">columnMap.put(<span class=\"string\">\"gender\"</span>,<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\"><span class=\"built_in\">List</span>&lt;Employee&gt; employees = emplopyeeDao.selectByMap(columnMap);</span><br><span class=\"line\">System.out.println(employees.size());</span><br></pre></td></tr></table></div></figure>\n<p>**注：**查询条件用map集合封装，columnMap，写的是数据表中的列名，而非实体类的属性名。比如属性名为lastName，数据表中字段为last_name，这里应该写的是last_name。selectByMap方法返回值用list集合接收。</p>\n<p>**(4)、**通过id批量查询：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;Integer&gt; idList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">idList.<span class=\"keyword\">add</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">idList.<span class=\"keyword\">add</span>(<span class=\"number\">2</span>);</span><br><span class=\"line\">idList.<span class=\"keyword\">add</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\">List&lt;Employee&gt; employees = emplopyeeDao.selectBatchIds(idList);</span><br><span class=\"line\">System.<span class=\"keyword\">out</span>.println(employees);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**把需要查询的id都add到list集合中，然后调用selectBatchIds方法，传入该list集合即可，该方法返回的是对应id的所有记录，所有返回值也是用list接收。</p>\n<p>**(5)、**分页查询：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;Employee&gt; employees = emplopyeeDao.selectPage(<span class=\"keyword\">new</span> Page&lt;&gt;(<span class=\"number\">1</span>,<span class=\"number\">2</span>),<span class=\"literal\">null</span>);</span><br><span class=\"line\">System.<span class=\"keyword\">out</span>.println(employees);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**selectPage方法就是分页查询，在page中传入分页信息，后者为null的分页条件，这里先让其为null，讲了条件构造器再说其用法。这个分页其实并不是物理分页，而是内存分页。也就是说，查询的时候并没有limit语句。等配置了分页插件后才可以实现真正的分页。</p>\n<p><strong>4、delete操作：</strong></p>\n<p>**(1)、**根据id删除：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">emplopyeeDao</span><span class=\"selector-class\">.deleteById</span>(1);</span><br></pre></td></tr></table></div></figure>\n<p>**(2)、**根据条件删除：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Map</span>&lt;<span class=\"built_in\">String</span>,<span class=\"built_in\">Object</span>&gt; columnMap = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">columnMap.put(<span class=\"string\">\"gender\"</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">columnMap.put(<span class=\"string\">\"age\"</span>,<span class=\"number\">18</span>);</span><br><span class=\"line\">emplopyeeDao.deleteByMap(columnMap);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**该方法与selectByMap类似，将条件封装在columnMap中，然后调用deleteByMap方法，传入columnMap即可，返回值是Integer类型，表示影响的行数。</p>\n<p>**(3)、**根据id批量删除：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;Integer&gt; idList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">idList.<span class=\"keyword\">add</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">idList.<span class=\"keyword\">add</span>(<span class=\"number\">2</span>);</span><br><span class=\"line\">emplopyeeDao.deleteBatchIds(idList);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**该方法和selectBatchIds类似，把需要删除的记录的id装进idList，然后调用deleteBatchIds，传入idList即可。</p>\n<h3 id=\"四-全局策略配置\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#四-全局策略配置\"></a> 四、全局策略配置：<a href=\"spring&mybatis/Mybatis - MybatisPlus#四-全局策略配置\"></a></h3>\n<p>通过上面的小案例我们可以发现，实体类需要加@TableName注解指定数据库表名，通过@TableId注解指定id的增长策略。实体类少倒也无所谓，实体类一多的话也麻烦。所以可以在spring-dao.xml的文件中进行全局策略配置。</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 5、mybatisplus的全局策略配置 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"globalConfiguration\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.baomidou.mybatisplus.entity.GlobalConfiguration\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 2.3版本后，驼峰命名默认值就是true，所以可不配置 --&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--&lt;property name=\"dbColumnUnderline\" value=\"true\"/&gt;--&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 全局主键自增策略，0表示auto --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"idType\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"0\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 全局表前缀配置 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"tablePrefix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"tb_\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>这里配置了还没用，还需要在sqlSessionFactory中注入配置才会生效。如下：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 3、配置mybatisplus的sqlSessionFactory --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"sqlSessionFactory\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"dataSource\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"configLocation\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath:mybatis-config.xml\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"typeAliasesPackage\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.zhu.mybatisplus.entity\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 注入全局配置 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"globalConfig\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"globalConfiguration\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>如此一来，实体类中的@TableName注解和@TableId注解就可以去掉了</p>\n<h3 id=\"五-条件构造器entitywrapper\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#五-条件构造器entitywrapper\"></a> 五、条件构造器(EntityWrapper)：<a href=\"spring&mybatis/Mybatis - MybatisPlus#五-条件构造器entitywrapper\"></a></h3>\n<p>以上基本的 CRUD 操作，我们仅仅需要继承一个 BaseMapper 即可实现大部分单表 CRUD 操作。BaseMapper 提供了多达 17 个方法供使用, 可以极其方便的实现单一、批量、分页等操作，极大的减少开发负担。但是mybatis-plus的强大不限于此，请看如下需求该如何处理：</p>\n<ul>\n<li><strong>需求：</strong>\n<ul>\n<li>我们需要分页查询 tb_employee 表中，年龄在 18~50 之间性别为男且姓名为 xx 的所有用户，这时候我们该如何实现上述需求呢？</li>\n</ul>\n</li>\n<li><strong>使用MyBatis :</strong> 需要在 SQL 映射文件中编写带条件查询的 SQL,并用PageHelper 插件完成分页. 实现以上一个简单的需求，往往需要我们做很多重复单调的工作。</li>\n<li><strong>使用MP:</strong> 依旧不用编写 SQL 语句，MP 提供了功能强大的条件构造器 ------  EntityWrapper。</li>\n</ul>\n<p><strong>接下来就直接看几个案例体会EntityWrapper的使用。</strong></p>\n<h4 id=\"1-分页查询年龄在18-50且gender为0-姓名为tom的用户\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#1-分页查询年龄在18-50且gender为0-姓名为tom的用户\"></a> <strong>1、分页查询年龄在18 - 50且gender为0、姓名为tom的用户：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#1-分页查询年龄在18-50且gender为0-姓名为tom的用户\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">List</span>&lt;Employee&gt; employees = emplopyeeDao.selectPage(<span class=\"keyword\">new</span> Page&lt;Employee&gt;(<span class=\"number\">1</span>,<span class=\"number\">3</span>),</span><br><span class=\"line\">     <span class=\"keyword\">new</span> EntityWrapper&lt;Employee&gt;()</span><br><span class=\"line\">        .between(<span class=\"string\">\"age\"</span>,<span class=\"number\">18</span>,<span class=\"number\">50</span>)</span><br><span class=\"line\">        .eq(<span class=\"string\">\"gender\"</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">        .eq(<span class=\"string\">\"last_name\"</span>,<span class=\"string\">\"tom\"</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**由此案例可知，分页查询和之前一样，new 一个page对象传入分页信息即可。至于分页条件，new 一个EntityWrapper对象，调用该对象的相关方法即可。between方法三个参数，分别是column、value1、value2，该方法表示column的值要在value1和value2之间；eq是equals的简写，该方法两个参数，column和value，表示column的值和value要相等。注意column是数据表对应的字段，而非实体类属性字段。</p>\n<h4 id=\"2-查询gender为0且名字中带有老师-或者邮箱中带有a的用户\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#2-查询gender为0且名字中带有老师-或者邮箱中带有a的用户\"></a> <strong>2、查询gender为0且名字中带有老师、或者邮箱中带有a的用户：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#2-查询gender为0且名字中带有老师-或者邮箱中带有a的用户\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">List</span>&lt;Employee&gt; employees = emplopyeeDao.selectList(</span><br><span class=\"line\">                <span class=\"keyword\">new</span> EntityWrapper&lt;Employee&gt;()</span><br><span class=\"line\">               .eq(<span class=\"string\">\"gender\"</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">               .like(<span class=\"string\">\"last_name\"</span>,<span class=\"string\">\"老师\"</span>)</span><br><span class=\"line\">                <span class=\"comment\">//.or()//和or new 区别不大</span></span><br><span class=\"line\">               .orNew()</span><br><span class=\"line\">               .like(<span class=\"string\">\"email\"</span>,<span class=\"string\">\"a\"</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**未说分页查询，所以用selectList即可，用EntityWrapper的like方法进行模糊查询，like方法就是指column的值包含value值，此处like方法就是查询last_name中包含“老师”字样的记录；“或者”用or或者orNew方法表示，这两个方法区别不大，用哪个都可以，可以通过控制台的sql语句自行感受其区别。</p>\n<h4 id=\"3-查询gender为0根据age排序简单分页\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#3-查询gender为0根据age排序简单分页\"></a> <strong>3、查询gender为0，根据age排序，简单分页：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#3-查询gender为0根据age排序简单分页\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">List</span>&lt;Employee&gt; employees = emplopyeeDao.selectList(</span><br><span class=\"line\">                <span class=\"keyword\">new</span> EntityWrapper&lt;Employee&gt;()</span><br><span class=\"line\">                .eq(<span class=\"string\">\"gender\"</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">                .orderBy(<span class=\"string\">\"age\"</span>)<span class=\"comment\">//直接orderby 是升序，asc</span></span><br><span class=\"line\">                .last(<span class=\"string\">\"desc limit 1,3\"</span>)<span class=\"comment\">//在sql语句后面追加last里面的内容(改为降序，同时分页)</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**简单分页是指不用page对象进行分页。orderBy方法就是根据传入的column进行升序排序，若要降序，可以使用orderByDesc方法，也可以如案例中所示用last方法；last方法就是将last方法里面的value值追加到sql语句的后面，在该案例中，最后的sql语句就变为<code>select ······ order by desc limit 1, 3</code>，追加了<code>desc limit 1,3</code>所以可以进行降序排序和分页。</p>\n<h4 id=\"4-分页查询年龄在18-50且gender为0-姓名为tom的用户\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#4-分页查询年龄在18-50且gender为0-姓名为tom的用户\"></a> <strong>4、分页查询年龄在18 - 50且gender为0、姓名为tom的用户：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#4-分页查询年龄在18-50且gender为0-姓名为tom的用户\"></a></h4>\n<p>条件构造器除了EntityWrapper，还有Condition。用Condition来处理一下这个需求：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">List</span>&lt;Employee&gt; employees = emplopyeeDao.selectPage(</span><br><span class=\"line\">               <span class=\"keyword\">new</span> Page&lt;Employee&gt;(<span class=\"number\">1</span>,<span class=\"number\">2</span>),</span><br><span class=\"line\">               Condition.create()</span><br><span class=\"line\">                       .between(<span class=\"string\">\"age\"</span>,<span class=\"number\">18</span>,<span class=\"number\">50</span>)</span><br><span class=\"line\">                       .eq(<span class=\"string\">\"gender\"</span>,<span class=\"string\">\"0\"</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**Condition和EntityWrapper的区别就是，创建条件构造器时，EntityWrapper是new出来的，而Condition是调create方法创建出来。</p>\n<h4 id=\"5-根据条件更新\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#5-根据条件更新\"></a> <strong>5、根据条件更新：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#5-根据条件更新\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testEntityWrapperUpdate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Employee employee = <span class=\"keyword\">new</span> Employee();</span><br><span class=\"line\">        employee.setLastName(<span class=\"string\">\"苍老师\"</span>);</span><br><span class=\"line\">        employee.setEmail(<span class=\"string\">\"cjk@sina.com\"</span>);</span><br><span class=\"line\">        employee.setGender(<span class=\"number\">0</span>);</span><br><span class=\"line\">        emplopyeeDao.update(employee,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> EntityWrapper&lt;Employee&gt;()</span><br><span class=\"line\">                .eq(<span class=\"string\">\"last_name\"</span>,<span class=\"string\">\"tom\"</span>)</span><br><span class=\"line\">                .eq(<span class=\"string\">\"age\"</span>,<span class=\"number\">25</span>)</span><br><span class=\"line\">        );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<p>**注：**该案例表示把last_name为tom，age为25的所有用户的信息更新为employee中设置的信息。</p>\n<h4 id=\"6-根据条件删除\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#6-根据条件删除\"></a> <strong>6、根据条件删除：</strong><a href=\"spring&mybatis/Mybatis - MybatisPlus#6-根据条件删除\"></a></h4>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">emplopyeeDao.<span class=\"keyword\">delete</span>(</span><br><span class=\"line\">        <span class=\"keyword\">new</span> EntityWrapper&lt;Employee&gt;()</span><br><span class=\"line\">        .eq(<span class=\"string\">\"last_name\"</span>,<span class=\"string\">\"tom\"</span>)</span><br><span class=\"line\">        .eq(<span class=\"string\">\"age\"</span>,<span class=\"number\">16</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></div></figure>\n<p>**注：**该案例表示把last_name为tom、age为16的所有用户删除。</p>\n<h3 id=\"代码生成工具\"><a class=\"markdownIt-Anchor\" href=\"spring&mybatis/Mybatis - MybatisPlus#代码生成工具\"></a> 代码生成工具<a href=\"spring&mybatis/Mybatis - MybatisPlus#代码生成工具\"></a></h3>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zhx.plus_demo2.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.core.toolkit.StringPool;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.generator.InjectionConfig;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.generator.config.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.generator.config.po.TableInfo;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.generator.config.rules.DateType;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 演示例子，执行 main 方法控制台输入模块表名回车自动生成对应项目目录中</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MpGenerator</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String projectPath = System.getProperty(<span class=\"string\">\"user.dir\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * 读取控制台内容</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">scanner</span><span class=\"params\">(String tip)</span> </span>&#123;</span><br><span class=\"line\">        Scanner scanner = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"请输入\"</span> + tip + <span class=\"string\">\"：\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (scanner.hasNext()) &#123;</span><br><span class=\"line\">            String ipt = scanner.next();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (StringUtils.isNotEmpty(ipt)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> ipt;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> MybatisPlusException(<span class=\"string\">\"请输入正确的\"</span> + tip + <span class=\"string\">\"！\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 全局配置</span></span><br><span class=\"line\">        GlobalConfig globalConfig = generateGlobalConfig();</span><br><span class=\"line\">        <span class=\"comment\">// 数据源配置</span></span><br><span class=\"line\">        DataSourceConfig dsc = generateDataSourceConfig();</span><br><span class=\"line\">        <span class=\"comment\">// 包设置</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> PackageConfig pc = generatePackageConfig();</span><br><span class=\"line\">        <span class=\"comment\">// 自定义设置</span></span><br><span class=\"line\">        InjectionConfig injectionConfig = generateInjectConfig(pc);</span><br><span class=\"line\">        <span class=\"comment\">// 策略配置</span></span><br><span class=\"line\">        StrategyConfig strategy = generateStrategy();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 配置模板</span></span><br><span class=\"line\">        TemplateConfig templateConfig = <span class=\"keyword\">new</span> TemplateConfig();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 配置自定义输出模板</span></span><br><span class=\"line\">        <span class=\"comment\">//指定自定义模板路径，注意不要带上.ftl/.vm, 会根据使用的模板引擎自动识别</span></span><br><span class=\"line\">        <span class=\"comment\">// templateConfig.setEntity(\"templates/entity2.java\");</span></span><br><span class=\"line\">        <span class=\"comment\">// templateConfig.setService();</span></span><br><span class=\"line\">        <span class=\"comment\">// templateConfig.setController();</span></span><br><span class=\"line\"></span><br><span class=\"line\">        templateConfig.setXml(<span class=\"keyword\">null</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 代码生成器</span></span><br><span class=\"line\">        AutoGenerator mpg = <span class=\"keyword\">new</span> AutoGenerator();</span><br><span class=\"line\">        mpg.setGlobalConfig(globalConfig);</span><br><span class=\"line\">        mpg.setDataSource(dsc);</span><br><span class=\"line\">        mpg.setPackageInfo(pc);</span><br><span class=\"line\">        mpg.setStrategy(strategy);</span><br><span class=\"line\">        mpg.setCfg(injectionConfig);</span><br><span class=\"line\">        mpg.setTemplate(templateConfig);</span><br><span class=\"line\"></span><br><span class=\"line\">        mpg.execute();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> StrategyConfig <span class=\"title\">generateStrategy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 策略配置</span></span><br><span class=\"line\">        StrategyConfig strategy = <span class=\"keyword\">new</span> StrategyConfig();</span><br><span class=\"line\">        <span class=\"comment\">// strategy.setCapitalMode(true);// 全局大写命名 ORACLE 注意</span></span><br><span class=\"line\">        <span class=\"comment\">//strategy.setTablePrefix(new String[] &#123; \"tlog_\", \"tsys_\" &#125;);// 此处可以修改为您的表前缀</span></span><br><span class=\"line\">        strategy.setNaming(NamingStrategy.underline_to_camel);<span class=\"comment\">// 表名生成策略</span></span><br><span class=\"line\">        strategy.setInclude(scanner(<span class=\"string\">\"表名\"</span>).split(<span class=\"string\">\",\"</span>)); <span class=\"comment\">// 需要生成的表</span></span><br><span class=\"line\">        strategy.setEntityLombokModel(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        strategy.setEntityBuilderModel(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        <span class=\"comment\">// strategy.setExclude(new String[]&#123;\"test\"&#125;); // 排除生成的表</span></span><br><span class=\"line\">        <span class=\"comment\">// 自定义实体父类</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setSuperEntityClass(\"com.baomidou.demo.TestEntity\");</span></span><br><span class=\"line\">        <span class=\"comment\">// 自定义实体，公共字段</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setSuperEntityColumns(new String[] &#123; \"test_id\", \"age\" &#125;);</span></span><br><span class=\"line\">        <span class=\"comment\">// 自定义 mapper 父类</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setSuperMapperClass(\"com.baomidou.demo.TestMapper\");</span></span><br><span class=\"line\">        <span class=\"comment\">// 自定义 service 父类</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setSuperServiceClass(\"com.baomidou.demo.TestService\");</span></span><br><span class=\"line\">        <span class=\"comment\">// 自定义 service 实现类父类</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setSuperServiceImplClass(\"com.baomidou.demo.TestServiceImpl\");</span></span><br><span class=\"line\">        <span class=\"comment\">// 自定义 controller 父类</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setSuperControllerClass(\"com.baomidou.demo.TestController\");</span></span><br><span class=\"line\">        <span class=\"comment\">// 【实体】是否生成字段常量（默认 false）</span></span><br><span class=\"line\">        <span class=\"comment\">// public static final String ID = \"test_id\";</span></span><br><span class=\"line\">        <span class=\"comment\">// strategy.setEntityColumnConstant(true);</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> strategy;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> InjectionConfig <span class=\"title\">generateInjectConfig</span><span class=\"params\">(PackageConfig pc)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 自定义配置</span></span><br><span class=\"line\">        InjectionConfig cfg = <span class=\"keyword\">new</span> InjectionConfig() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">initMap</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"comment\">// to do nothing</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 如果模板引擎是 freemarker</span></span><br><span class=\"line\"><span class=\"comment\">//        String templatePath = \"/templates/mapper.xml.ftl\";</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果模板引擎是 velocity</span></span><br><span class=\"line\">        String templatePath = <span class=\"string\">\"/templates/mapper.xml.vm\"</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 自定义输出配置</span></span><br><span class=\"line\">        List&lt;FileOutConfig&gt; focList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"comment\">// 自定义配置会被优先输出</span></span><br><span class=\"line\">        focList.add(<span class=\"keyword\">new</span> FileOutConfig(templatePath) &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">outputFile</span><span class=\"params\">(TableInfo tableInfo)</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"comment\">// 自定义输出文件名 ， 如果你 Entity 设置了前后缀、此处注意 xml 的名称会跟着发生变化！！</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> projectPath + <span class=\"string\">\"/src/main/resources/mapper/\"</span> +</span><br><span class=\"line\">                        <span class=\"string\">\"/\"</span> + tableInfo.getEntityName() + <span class=\"string\">\"Mapper\"</span> + StringPool.DOT_XML;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        cfg.setFileCreate(new IFileCreate() &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            @Override</span></span><br><span class=\"line\"><span class=\"comment\">            public boolean isCreate(ConfigBuilder configBuilder, FileType fileType, String filePath) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                // 判断自定义文件夹是否需要创建</span></span><br><span class=\"line\"><span class=\"comment\">                checkDir(\"调用默认方法创建的目录\");</span></span><br><span class=\"line\"><span class=\"comment\">                return false;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;);</span></span><br><span class=\"line\"><span class=\"comment\">        */</span></span><br><span class=\"line\">        cfg.setFileOutConfigList(focList);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cfg;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> PackageConfig <span class=\"title\">generatePackageConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> PackageConfig pc = <span class=\"keyword\">new</span> PackageConfig();</span><br><span class=\"line\"><span class=\"comment\">//        pc.setModuleName(scanner(\"模块名\"));</span></span><br><span class=\"line\">        <span class=\"comment\">// 包配置</span></span><br><span class=\"line\"><span class=\"comment\">//        final PackageConfig pc = new PackageConfig();</span></span><br><span class=\"line\"><span class=\"comment\">//        pc.setModuleName(scanner(\"模块名\"));</span></span><br><span class=\"line\"><span class=\"comment\">//        pc.setParent(\"com.nfsq.es.demo.bean\");</span></span><br><span class=\"line\"></span><br><span class=\"line\">        pc.setParent(<span class=\"string\">\"cn.ng.springboot\"</span>);</span><br><span class=\"line\">        pc.setMapper(<span class=\"string\">\"dao.mapper\"</span>);<span class=\"comment\">//生成mapper接口</span></span><br><span class=\"line\">        pc.setEntity(<span class=\"string\">\"dao.entity\"</span>);</span><br><span class=\"line\">        pc.setServiceImpl(<span class=\"string\">\"service.impl\"</span>);</span><br><span class=\"line\">        pc.setService(<span class=\"string\">\"service\"</span>);</span><br><span class=\"line\">        pc.setXml(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pc;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> DataSourceConfig <span class=\"title\">generateDataSourceConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        DataSourceConfig dataSource = <span class=\"keyword\">new</span> DataSourceConfig();</span><br><span class=\"line\"><span class=\"comment\">//        dsc.setDbType(DbType.MYSQL);</span></span><br><span class=\"line\">        dataSource.setDriverName(<span class=\"string\">\"com.mysql.jdbc.Driver\"</span>);</span><br><span class=\"line\">        dataSource.setUsername(<span class=\"string\">\"root\"</span>);</span><br><span class=\"line\">        dataSource.setPassword(<span class=\"string\">\"root\"</span>);</span><br><span class=\"line\">        dataSource.setUrl(<span class=\"string\">\"jdbc:mysql://localhost:3306/hive\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//        // 数据源配置</span></span><br><span class=\"line\"><span class=\"comment\">//        DataSourceConfig dsc = new DataSourceConfig();</span></span><br><span class=\"line\"><span class=\"comment\">//        dsc.setUrl(\"jdbc:mysql://localhost:3306/es_demo?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8\");</span></span><br><span class=\"line\"><span class=\"comment\">//        // dsc.setSchemaName(\"public\");</span></span><br><span class=\"line\"><span class=\"comment\">//        dsc.setDriverName(\"com.mysql.jdbc.Driver\");</span></span><br><span class=\"line\"><span class=\"comment\">//        dsc.setUsername(\"root\");</span></span><br><span class=\"line\"><span class=\"comment\">//        dsc.setPassword(\"aptx1230\");</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> dataSource;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> GlobalConfig <span class=\"title\">generateGlobalConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 全局配置</span></span><br><span class=\"line\">        GlobalConfig gc = <span class=\"keyword\">new</span> GlobalConfig();</span><br><span class=\"line\">        gc.setOutputDir(projectPath + <span class=\"string\">\"/src/main/java\"</span>);</span><br><span class=\"line\">        gc.setAuthor(<span class=\"string\">\"ng\"</span>);</span><br><span class=\"line\">        gc.setOpen(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        gc.setFileOverride(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        gc.setActiveRecord(<span class=\"keyword\">true</span>);<span class=\"comment\">// 不需要ActiveRecord特性的请改为false</span></span><br><span class=\"line\">        gc.setEnableCache(<span class=\"keyword\">false</span>);<span class=\"comment\">// XML 二级缓存</span></span><br><span class=\"line\">        gc.setBaseResultMap(<span class=\"keyword\">true</span>);<span class=\"comment\">// XML ResultMap</span></span><br><span class=\"line\">        gc.setBaseColumnList(<span class=\"keyword\">false</span>);<span class=\"comment\">// XML columList</span></span><br><span class=\"line\">        gc.setKotlin(<span class=\"keyword\">false</span>); <span class=\"comment\">// 是否生成 kotlin 代码</span></span><br><span class=\"line\">        gc.setDateType(DateType.ONLY_DATE); <span class=\"comment\">//时间类型的映射规则</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> gc;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n","prev":{"title":"spring&mybatis/Java Web","link":"spring&mybatis/Java Web"},"next":{"title":"spring&mybatis/Spring Cloud","link":"spring&mybatis/Spring Cloud"},"plink":"ilucia.github.io/spring&mybatis/Mybatis - MybatisPlus/","toc":[{"title":"<a class=\"markdownIt-Anchor\"></a> Mybatis","id":"mybatis","index":"1","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> 步骤","id":"步骤","index":"1.1","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> 创建工具类测试","id":"创建工具类测试","index":"1.1.1"}]},{"title":"<a class=\"markdownIt-Anchor\"></a> 扩展功能","id":"扩展功能","index":"1.2","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> 创建DAO","id":"创建dao","index":"1.2.1"},{"title":"<a class=\"markdownIt-Anchor\"></a> 分页","id":"分页","index":"1.2.2"},{"title":"<a class=\"markdownIt-Anchor\"></a> 动态SQL","id":"动态sql","index":"1.2.3"}]}]},{"title":"<a class=\"markdownIt-Anchor\"></a> choose, when, otherwise","id":"choose-when-otherwise","index":"2"},{"title":"<a class=\"markdownIt-Anchor\"></a> trim, where, set","id":"trim-where-set","index":"3"},{"title":"<a class=\"markdownIt-Anchor\"></a> foreach","id":"foreach","index":"4"},{"title":"<a class=\"markdownIt-Anchor\"></a> bind","id":"bind","index":"5"},{"title":"<a class=\"markdownIt-Anchor\"></a> Multi-db vendor support","id":"multi-db-vendor-support","index":"6"},{"title":"<a class=\"markdownIt-Anchor\"></a> 动态 SQL 中可插拔的脚本语言","id":"动态-sql-中可插拔的脚本语言","index":"7","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> 注解","id":"注解","index":"7.1","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> 映射申明样例","id":"映射申明样例","index":"7.1.1"}]}]},{"title":"<a class=\"markdownIt-Anchor\"></a> MyBatis Plus","id":"mybatis-plus","index":"8","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> 一、mybatis-plus简介：","id":"一-mybatis-plus简介","index":"8.1"},{"title":"<a class=\"markdownIt-Anchor\"></a> 二、spring整合mybatis-plus:","id":"二-spring整合mybatis-plus","index":"8.2","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>1、pom.xml:</strong>","id":"1-pomxml","index":"8.2.1"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>2、log4j.xml:</strong>","id":"2-log4jxml","index":"8.2.2"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>3、jdbc.properties:</strong>","id":"3-jdbcproperties","index":"8.2.3"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>4、mybatis-config.xml:</strong>","id":"4-mybatis-configxml","index":"8.2.4"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>5、spring-dao.xml:</strong>","id":"5-spring-daoxml","index":"8.2.5"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>6、entity:</strong>","id":"6-entity","index":"8.2.6"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>7、mapper:</strong>","id":"7-mapper","index":"8.2.7"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>8、测试：</strong>","id":"8-测试","index":"8.2.8"}]},{"title":"<a class=\"markdownIt-Anchor\"></a> 三、mp的通用crud","id":"三-mp的通用crud","index":"8.3","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>1、insert操作：</strong>","id":"1-insert操作","index":"8.3.1"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>2、update操作：</strong>","id":"2-update操作","index":"8.3.2"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>3、select操作：</strong>","id":"3-select操作","index":"8.3.3"}]},{"title":"<a class=\"markdownIt-Anchor\"></a> 四、全局策略配置：","id":"四-全局策略配置","index":"8.4"},{"title":"<a class=\"markdownIt-Anchor\"></a> 五、条件构造器(EntityWrapper)：","id":"五-条件构造器entitywrapper","index":"8.5","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>1、分页查询年龄在18 - 50且gender为0、姓名为tom的用户：</strong>","id":"1-分页查询年龄在18-50且gender为0-姓名为tom的用户","index":"8.5.1"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>2、查询gender为0且名字中带有老师、或者邮箱中带有a的用户：</strong>","id":"2-查询gender为0且名字中带有老师-或者邮箱中带有a的用户","index":"8.5.2"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>3、查询gender为0，根据age排序，简单分页：</strong>","id":"3-查询gender为0根据age排序简单分页","index":"8.5.3"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>4、分页查询年龄在18 - 50且gender为0、姓名为tom的用户：</strong>","id":"4-分页查询年龄在18-50且gender为0-姓名为tom的用户","index":"8.5.4"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>5、根据条件更新：</strong>","id":"5-根据条件更新","index":"8.5.5"},{"title":"<a class=\"markdownIt-Anchor\"></a> <strong>6、根据条件删除：</strong>","id":"6-根据条件删除","index":"8.5.6"}]},{"title":"<a class=\"markdownIt-Anchor\"></a> 代码生成工具","id":"代码生成工具","index":"8.6"}]}],"copyright":{"author":"Ilucia Niu","license":"<a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\">知识共享署名 4.0 国际许可协议</a>","published":"2022年4月27日","updated":"2022年4月27日"}}