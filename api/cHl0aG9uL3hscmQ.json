{"title":"Python Excel file reader","date":"2018-10-01T00:00:00.000Z","link":"python/xlrd","tags":["Python excel"],"updated":"2022-04-27T15:24:01.731Z","content":"<h1 id=\"python-xlrd\"><a class=\"markdownIt-Anchor\" href=\"python/xlrd#python-xlrd\"></a> python xlrd<a href=\"python/xlrd#python-xlrd\"></a></h1>\n<p>1、导入模块<br>\nimport xlrd<br>\n2、打开Excel文件读取数据</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data = xlrd.open_workbook(<span class=\"string\">'excelFile.xls'</span>)</span><br></pre></td></tr></table></div></figure>\n<p>3、使用方法<br>\n获取一个工作表</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">table = data.sheets()[<span class=\"number\">0</span>]      <span class=\"comment\">#通过索引顺序获取</span></span><br><span class=\"line\">table = data.sheet_by_index(<span class=\"number\">0</span>) <span class=\"comment\">#通过索引顺序获取</span></span><br><span class=\"line\">table = data.sheet_by_name(<span class=\"string\">u'Sheet1'</span>)<span class=\"comment\">#通过名称获取</span></span><br><span class=\"line\"><span class=\"comment\">#获取整行和整列的值（数组）</span></span><br><span class=\"line\">table.row_values(i)</span><br><span class=\"line\">table.col_values(i)</span><br><span class=\"line\"><span class=\"comment\">#获取行数和列数</span></span><br><span class=\"line\">nrows = table.nrows</span><br><span class=\"line\">ncols = table.ncols</span><br><span class=\"line\"><span class=\"comment\">#循环行列表数据</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nrows ):</span><br><span class=\"line\"><span class=\"keyword\">print</span> table.row_values(i)</span><br><span class=\"line\"><span class=\"comment\">#单元格</span></span><br><span class=\"line\">cell_A1 = table.cell(<span class=\"number\">0</span>,<span class=\"number\">0</span>).value</span><br><span class=\"line\">cell_C4 = table.cell(<span class=\"number\">2</span>,<span class=\"number\">3</span>).value</span><br><span class=\"line\"><span class=\"comment\">#使用行列索引</span></span><br><span class=\"line\">cell_A1 = table.row(<span class=\"number\">0</span>)[<span class=\"number\">0</span>].value</span><br><span class=\"line\">cell_A2 = table.col(<span class=\"number\">1</span>)[<span class=\"number\">0</span>].value</span><br><span class=\"line\"><span class=\"comment\">#简单的写入</span></span><br><span class=\"line\">row = <span class=\"number\">0</span></span><br><span class=\"line\">col = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"comment\">#类型 0 empty,1 string, 2 number, 3 date, 4 boolean, 5 error</span></span><br><span class=\"line\">ctype = <span class=\"number\">1</span> value = <span class=\"string\">'单元格的值'</span></span><br><span class=\"line\">xf = <span class=\"number\">0</span> <span class=\"comment\"># 扩展的格式化</span></span><br><span class=\"line\">table.put_cell(row, col, ctype, value, xf)</span><br><span class=\"line\">table.cell(<span class=\"number\">0</span>,<span class=\"number\">0</span>)  <span class=\"comment\">#单元格的值'</span></span><br><span class=\"line\">table.cell(<span class=\"number\">0</span>,<span class=\"number\">0</span>).value <span class=\"comment\">#单元格的值'</span></span><br><span class=\"line\"><span class=\"comment\"># python xlrd</span></span><br></pre></td></tr></table></div></figure>\n<h2 id=\"demo\"><a class=\"markdownIt-Anchor\" href=\"python/xlrd#demo\"></a> Demo<a href=\"python/xlrd#demo\"></a></h2>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*- </span></span><br><span class=\"line\"><span class=\"keyword\">import</span>  xdrlib ,sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> xlrd</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">open_excel</span><span class=\"params\">(file= <span class=\"string\">'file.xls'</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        data = xlrd.open_workbook(file)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> data</span><br><span class=\"line\">    <span class=\"keyword\">except</span> Exception,e:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> str(e)</span><br><span class=\"line\"><span class=\"comment\">#根据索引获取Excel表格中的数据   参数:file：Excel文件路径     colnameindex：表头列名所在行的所以  ，by_index：表的索引</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">excel_table_byindex</span><span class=\"params\">(file= <span class=\"string\">'file.xls'</span>,colnameindex=<span class=\"number\">0</span>,by_index=<span class=\"number\">0</span>)</span>:</span></span><br><span class=\"line\">    data = open_excel(file)</span><br><span class=\"line\">    table = data.sheets()[by_index]</span><br><span class=\"line\">    nrows = table.nrows <span class=\"comment\">#行数</span></span><br><span class=\"line\">    ncols = table.ncols <span class=\"comment\">#列数</span></span><br><span class=\"line\">    colnames =  table.row_values(colnameindex) <span class=\"comment\">#某一行数据 </span></span><br><span class=\"line\">    list =[]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> rownum <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,nrows):</span><br><span class=\"line\"></span><br><span class=\"line\">         row = table.row_values(rownum)</span><br><span class=\"line\">         <span class=\"keyword\">if</span> row:</span><br><span class=\"line\">             app = &#123;&#125;</span><br><span class=\"line\">             <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(colnames)):</span><br><span class=\"line\">                app[colnames[i]] = row[i] </span><br><span class=\"line\">             list.append(app)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#根据名称获取Excel表格中的数据   参数:file：Excel文件路径     colnameindex：表头列名所在行的所以  ，by_name：Sheet1名称</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">excel_table_byname</span><span class=\"params\">(file= <span class=\"string\">'file.xls'</span>,colnameindex=<span class=\"number\">0</span>,by_name=<span class=\"string\">u'Sheet1'</span>)</span>:</span></span><br><span class=\"line\">    data = open_excel(file)</span><br><span class=\"line\">    table = data.sheet_by_name(by_name)</span><br><span class=\"line\">    nrows = table.nrows <span class=\"comment\">#行数 </span></span><br><span class=\"line\">    colnames =  table.row_values(colnameindex) <span class=\"comment\">#某一行数据 </span></span><br><span class=\"line\">    list =[]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> rownum <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,nrows):</span><br><span class=\"line\">         row = table.row_values(rownum)</span><br><span class=\"line\">         <span class=\"keyword\">if</span> row:</span><br><span class=\"line\">             app = &#123;&#125;</span><br><span class=\"line\">             <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(colnames)):</span><br><span class=\"line\">                app[colnames[i]] = row[i]</span><br><span class=\"line\">             list.append(app)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">   tables = excel_table_byindex()</span><br><span class=\"line\">   <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> tables:</span><br><span class=\"line\">       <span class=\"keyword\">print</span> row</span><br><span class=\"line\"></span><br><span class=\"line\">   tables = excel_table_byname()</span><br><span class=\"line\">   <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> tables:</span><br><span class=\"line\">       <span class=\"keyword\">print</span> row</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></div></figure>","prev":{"title":"OpenCV function reference","link":"OpenCV/OpenCVFunctionRef"},"next":{"title":"Python function reference","link":"python/PythonFunctionRef"},"plink":"ilucia.github.io/python/xlrd/","toc":[{"title":"<a class=\"markdownIt-Anchor\"></a> python xlrd","id":"python-xlrd","index":"1","children":[{"title":"<a class=\"markdownIt-Anchor\"></a> Demo","id":"demo","index":"1.1"}]}],"copyright":{"author":"Ilucia Niu","license":"<a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\">知识共享署名 4.0 国际许可协议</a>","published":"2018年10月1日","updated":"2022年4月27日"}}