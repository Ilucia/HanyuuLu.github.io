{"title":"Python中遍历List时删除元素","date":"2019-07-13T00:00:00.000Z","link":"python/delInList","tags":["Python"],"updated":"2022-04-27T15:24:01.731Z","content":"<h2 id=\"场景复现\"><a class=\"markdownIt-Anchor\" href=\"python/delInList#场景复现\"></a> 场景复现<a href=\"python/delInList#场景复现\"></a></h2>\n<ul>\n<li>举一个简单的栗子</li>\n</ul>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(numList)):</span><br><span class=\"line\"><span class=\"meta\">... </span>    <span class=\"keyword\">del</span>(numList[i])</span><br><span class=\"line\">...</span><br><span class=\"line\">Traceback (most recent call last):</span><br><span class=\"line\">  File <span class=\"string\">\"&lt;stdin&gt;\"</span>, line <span class=\"number\">2</span>, <span class=\"keyword\">in</span> &lt;module&gt;</span><br><span class=\"line\">IndexError: list assignment index out of range</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>print(numList)</span><br><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>]</span><br></pre></td></tr></table></div></figure>\n<ul>\n<li>这里还有另一个栗子</li>\n</ul>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> numList:</span><br><span class=\"line\"><span class=\"meta\">... </span>    numList.remove(i)</span><br><span class=\"line\"><span class=\"meta\">... </span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>print(numList)</span><br><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>]</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"错误原因\"><a class=\"markdownIt-Anchor\" href=\"python/delInList#错误原因\"></a> 错误原因<a href=\"python/delInList#错误原因\"></a></h2>\n<ul>\n<li>不难发现在遍历python的list的时候删除该list的元素这个操作往往不会按照我们的预期运行</li>\n<li>当使用for发起遍历操作时，for的遍历顺序已经确定了，删除操作会导致列表索引的变化，这可能引起\n<ul>\n<li>元素没有按照预期删除</li>\n<li>数组访问越界</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"解决方案\"><a class=\"markdownIt-Anchor\" href=\"python/delInList#解决方案\"></a> 解决方案<a href=\"python/delInList#解决方案\"></a></h2>\n<ul>\n<li>\n<p>删除操作在遍历操作之后(记录待删除元素)</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>delList = list() </span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> numList:  </span><br><span class=\"line\"><span class=\"meta\">... </span>    <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\"><span class=\"meta\">... </span>            delList.append(i)</span><br><span class=\"line\"><span class=\"meta\">... </span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> delList: </span><br><span class=\"line\"><span class=\"meta\">... </span>    numList.remove(i)</span><br><span class=\"line\"><span class=\"meta\">... </span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList</span><br><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>]</span><br><span class=\"line\">&gt;&gt;&gt;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li>\n<p>使用替代数组</p>\n<ul>\n<li>\n<p>Filter</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = filter(<span class=\"keyword\">lambda</span> x : x % <span class=\"number\">2</span> == <span class=\"number\">0</span>, numList)</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>print(numList)</span><br><span class=\"line\">&lt;filter object at <span class=\"number\">0x000002B358100470</span>&gt;</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> numList:</span><br><span class=\"line\"><span class=\"meta\">... </span>    print(i)</span><br><span class=\"line\"><span class=\"meta\">... </span></span><br><span class=\"line\"><span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">6</span></span><br><span class=\"line\"><span class=\"number\">8</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li>\n<p>List</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))                   </span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> numList <span class=\"keyword\">if</span> x % <span class=\"number\">2</span> == <span class=\"number\">0</span>]</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList</span><br><span class=\"line\">[<span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>]</span><br></pre></td></tr></table></div></figure>\n</li>\n</ul>\n</li>\n<li>\n<p>遍历list的备份</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))                   </span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> numList[:]:</span><br><span class=\"line\"><span class=\"meta\">... </span>    <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\"><span class=\"meta\">... </span>            numList.remove(i)</span><br><span class=\"line\"><span class=\"meta\">... </span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList</span><br><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>]</span><br></pre></td></tr></table></div></figure>\n</li>\n<li>\n<p>逆序遍历</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList = list(range(<span class=\"number\">10</span>))   </span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(numList) - <span class=\"number\">1</span>, <span class=\"number\">-1</span> , <span class=\"number\">-1</span>):</span><br><span class=\"line\"><span class=\"meta\">... </span>    <span class=\"keyword\">if</span> numList[i] % <span class=\"number\">2</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\"><span class=\"meta\">... </span>            <span class=\"keyword\">del</span>(numList[i])</span><br><span class=\"line\"><span class=\"meta\">... </span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>numList</span><br><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>]</span><br></pre></td></tr></table></div></figure>\n</li>\n</ul>\n","prev":{"title":"简单的k-means实践","link":"Others/k-means"},"next":{"title":"操作系统原理总结","link":"Review/OS"},"plink":"ilucia.github.io/python/delInList/","toc":[{"title":"<a class=\"markdownIt-Anchor\"></a> 场景复现","id":"场景复现","index":"1"},{"title":"<a class=\"markdownIt-Anchor\"></a> 错误原因","id":"错误原因","index":"2"},{"title":"<a class=\"markdownIt-Anchor\"></a> 解决方案","id":"解决方案","index":"3"}],"copyright":{"author":"Ilucia Niu","license":"<a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\">知识共享署名 4.0 国际许可协议</a>","published":"2019年7月13日","updated":"2022年4月27日"}}